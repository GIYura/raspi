#### СОДЕРЖАНИЕ

```
src-0 - пример драйвера LED (абстракция - ч.1);
src-1 - пример драйвера LED (talk-to-hardware - ч.2);
src-2 - 
src-3 - 
src-4
```

#### Введение

1. Скомпилировать драйвер. Для этого в корневом каталоге исходников драйвера выполнить:
```
make
```

2. Создать файл устройства. Для этого необходимо выполнить:
```
sudo mknod /dev/device-name c MAJOR MINOR
```
- device-name - имя файла устройства;
- с - указание, того что это character device;

**NOTE:** для просмотра MAJOR номера выполнить:
```
cat /proc/devices
```

3. Загрузка драйвера. Для этого необходимо выполнить:
```
make load
```

4. Тестирование. 
```
echo 1 > /dev/device-name
echo 0 > /dev/device-name
cat /dev/device-name
```

**NOTE:** изменить владельца файла /dev/device-name
```
sudo chown USER:GROUP /dev/device-name
```

5. Выгрузка драйвера. Для этого необходимо выполнить:
```
make unload
```

#### Аппаратура

Существует 2 основных способа MCU общения с переферийным устройством:
- Port I/O - выделенная шина используется для общения с устройством;
- Memory-mapped I/O - отображение памяти устройства в процесс драйвера.

1. Запрос доступа к MMIO;
```
request_mem_region();
```

2. Отображение адресов физической памяти в адреса виртуальной памяти;
```
ioremap();
```

3. Использовать API ядра для чтения / записи регистров.
```
readl()/writel();
```

**NOTE:**
Адрес периферии можно узнать выполнив команду:
```
sudo cat /proc/iomem
```

